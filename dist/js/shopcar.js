"use strict";function fn2(){$.ajax({type:"get",url:"../api/select_cart.php",async:!0,success:function(t){var e=JSON.parse(t);console.log(e);for(var c="",n=0;n<e.length;n++){var a=e[n].price*e[n].number;c+='<ul id="'+e[n].id+'" class="order_lists">\n\t\t\t\t\t\t\t\t<li class="list_chk ccc">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" id="checkbox_2" class="son_check">\n\t\t\t\t\t\t\t\t\t<label for="checkbox_2"></label>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class="list_con">\n\t\t\t\t\t\t\t\t\t<div class="list_img">\n\t\t\t\t\t\t\t\t\t\t<a href="javascript:;"><img src="../'+e[n].img+'" alt=""></a>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="list_text">\n\t\t\t\t\t\t\t\t\t\t<a href="javascript:;">'+e[n].content+'</a>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class="list_info">\n\t\t\t\t\t\t\t\t\t<p>规格：默认</p>\n\t\t\t\t\t\t\t\t\t<p>尺寸：16*16*3(cm)</p>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class="list_price">\n\t\t\t\t\t\t\t\t\t<p class="price">￥'+e[n].price+'</p>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class="list_amount">\n\t\t\t\t\t\t\t\t\t<div class="amount_box">\n\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="reduce reSty">-</a>\n\t\t\t\t\t\t\t\t\t\t<input type="text" value="'+e[n].number+'" class="sum">\n\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="plus">+</a>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class="list_sum">\n\t\t\t\t\t\t\t\t\t<p class="sum_price">￥<span>'+a+'</span></p>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class="list_op">\n\t\t\t\t\t\t\t\t\t<p class="del">\n\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="delBtn">移除商品</a>\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>'}$(".order_content").html(c)}})}fn2();var arr=[];function price(t){var e=t.parent().find("input").val(),c=t.parent().prev().text();c=(c=$.trim(c)).substring(2),console.log(e,c);var n=(c*e).toFixed(2);t.parent().next().html("￥&nbsp;"+n),updateNum(arr)}function updata(){0==$(".plus").size()&&$("#del").remove()}$(".order_content").on("click",".plus",function(){var t=$(this).prev().val();100<=++t&&(t=100),$(this).prev().val(t);var e=$(this).parent().parent().parent().attr("id");$.ajax({type:"get",url:"../api/add.php",async:!0,data:{id:e},success:function(t){console.log(t)}}),price($(this)),fn2(),updata()}),$(".order_content").on("click",".reduce",function(){var t=$(this).next().val();t--,console.log(t),t<=1&&(t=1),$(this).next().val(t);var e=$(this).parent().parent().parent().attr("id");$.ajax({type:"get",url:"../api/delete_cart.php",async:!0,data:{id:e},success:function(t){console.log(t)}}),price($(this)),fn2(),updata()}),$(".order_content").on("click",".del",function(){confirm("您确定要删除该商品吗？")&&$(this).parent().parent().remove(),updata(),updateNum(),allprice(arr);var t=$(this).parent().parent().attr("id");console.log(t),$.ajax({type:"get",url:"../api/delect_cart2.php",async:!0,data:{id:t}})});var isok=!0;function checked(){for(var t=[],e=$(".ccc input").size(),c=0;c<e;c++)$(".ccc input").eq(c).prop("checked")&&t.push(c);return t}function allnum(t){for(var e=0,c=0;c<t.length;c++)e+=parseInt($(".sum").eq(t[c]).val());$(".piece").html("已选 "+e+" 件商品"),$(".piece .piece_num").css("color","#FF7500")}function allprice(t){for(var e=0,c=0;c<t.length;c++){var n=$(".sum_price").eq(t[c]).text();n=$.trim(n),console.log(n),n=n.substring(2),console.log(n),e+=1*n}$(".totalMoney").html("总计（不含运费）：￥"+e.toFixed(2))}function updateNum(t){for(var e=0,c=0,n=0;n<t.length;n++){e+=1*$(".sum").eq(t[n]).val();var a=$(".sum_price span").eq(t[n]).html();console.log(a),c+=1*a}$(".piece").html("已选 "+e+" 件商品"),$(".totalMoney").html("总计（不含运费）：￥ "+1*c)}$("#allchecked").on("click",function(){isok?($(".ccc input").prop("checked","checked"),$("#allchecked input").prop("checked","checked")):($(".ccc input").removeAttr("checked"),$("#allchecked input").removeAttr("checked")),isok=!isok;var t=checked();updateNum(t),allnum(t)}),$(".order_content").on("click",".ccc input",function(){var t=checked();updateNum(t),isok=t.length==$(".ccc").size()?($("#allchecked input").prop("checked","checked"),!1):($("#allchecked input").removeAttr("checked"),!0),allnum(t)}),$(".quanshan").on("click",function(){var e=checked();updateNum(e),console.log(e),$.ajax({type:"get",url:"../api/delete_all.php",async:!0,success:function(){if(confirm("您确定要删除多行吗？"))for(var t=e.length-1;0<=t;t--)$(".ccc").eq(e[t]).parent().remove()}}),updata()}),$(".order_content").on("blur",".sum",function(){price($(this)),updateNum()});